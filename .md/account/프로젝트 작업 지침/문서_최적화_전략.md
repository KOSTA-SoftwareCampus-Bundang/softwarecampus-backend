# 문서 최적화 전략

**작성일:** 2025-11-12  
**목적:** 대용량 문서를 주제별로 분리하여 토큰 사용량 절감 및 가독성 향상

---

## 📋 개요

프로젝트 문서가 1000줄 이상으로 커지면 다음과 같은 문제가 발생합니다:
- AI 읽을 때마다 대량의 토큰 소모 (1000줄 ≈ 50,000 토큰)
- 필요한 정보를 찾기 어려움
- 문서 유지보수 어려움

**해결책:** 주제별로 문서를 분리하여 필요한 부분만 선택적으로 읽기

---

## 🎯 최적화 원칙

### 1. 인덱스 파일 + 상세 파일 구조
```
phase_name.md                    # 인덱스 파일 (50-100줄)
└── phase_name/
    ├── README.md                # 개요
    ├── 01_topic1.md             # 주제1 (100-200줄)
    ├── 02_topic2.md             # 주제2 (100-200줄)
    └── 03_topic3.md             # 주제3 (100-200줄)
```

### 2. 분리 기준
- **인덱스 파일**: 목차, 빠른 참조, 링크만 포함
- **상세 파일**: 각 주제별로 독립적으로 읽을 수 있도록 분리
- **파일 크기**: 개별 파일은 100-200줄 이내 권장

### 3. 명명 규칙
- **인덱스**: `phase_name.md` (기존 파일명 유지)
- **디렉토리**: `phase_name/` (인덱스 파일과 동일한 이름)
- **상세 파일**: `01_topic.md`, `02_topic.md` (번호 + 주제)

---

## 📂 Phase 5 적용 사례

### Before (최적화 전)
```
phases/
└── phase05_service_layer.md     # 1,100줄
```

**문제점:**
- 읽을 때마다 약 55,000 토큰 소모
- SignupService만 확인하려 해도 전체 문서 로드 필요

### After (최적화 후)
```
phases/
├── phase05_service_layer.md          # 인덱스 (50줄)
└── phase05/
    ├── README.md                      # 개요
    ├── 01_service_design.md           # 설계 원칙 (100줄)
    ├── 02_signup_service.md           # SignupService (180줄)
    ├── 03_profile_service.md          # ProfileService (100줄)
    ├── 04_exceptions.md               # 도메인 예외 (100줄)
    ├── 05_email_utils.md              # EmailUtils (120줄)
    ├── 06_exception_handler.md        # ExceptionHandler (100줄)
    ├── 07_dto_changes.md              # DTO 수정 (60줄)
    └── 08_verification.md             # 검증 기준 (80줄)
```

**개선 효과:**
- SignupService만 확인 시: 180줄 ≈ 9,000 토큰 (85% 절감)
- 전체 확인 시에도 선택적으로 필요한 파일만 읽기 가능
- 문서 유지보수 용이

---

## ✅ 최적화 체크리스트

### 분리가 필요한 문서 식별
- [ ] 파일이 500줄 이상인가?
- [ ] 여러 개의 독립적인 주제를 다루는가?
- [ ] 자주 참조되는 특정 섹션이 있는가?

### 분리 작업
1. [ ] 주제별로 섹션 구분 (보통 3-8개)
2. [ ] `phase_name/` 디렉토리 생성
3. [ ] 각 주제를 개별 파일로 분리
4. [ ] 인덱스 파일 생성 (목차 + 링크)
5. [ ] 상호 참조 링크 업데이트

### 검증
- [ ] 모든 링크가 올바르게 작동하는가?
- [ ] 각 파일이 독립적으로 읽기 가능한가?
- [ ] 인덱스 파일에서 전체 구조를 파악할 수 있는가?

---

## 📝 인덱스 파일 템플릿

```markdown
# Phase N: [Phase 이름]

**목표:** [목표 설명]  
**담당자:** [담당자]  
**상태:** [상태]

---

## 📋 작업 개요

[간단한 개요 설명]

> ⚠️ **이 파일은 이제 인덱스 파일로만 사용됩니다.**  
> 상세 내용은 `phaseN/` 디렉토리의 개별 문서를 참조하세요.

---

## 📂 문서 구조

1. **[주제1](./phaseN/01_topic1.md)** - 설명
2. **[주제2](./phaseN/02_topic2.md)** - 설명
3. **[주제3](./phaseN/03_topic3.md)** - 설명

---

## 🎯 빠른 참조

### 핵심 정보
[자주 참조되는 정보를 간단히 요약]

---

**작성일:** YYYY-MM-DD  
**최종 수정:** YYYY-MM-DD (문서 구조 최적화)  
**상태:** ✅ [상태]
```

---

## 🎨 상세 파일 템플릿

```markdown
# N. [주제 이름]

## [섹션1]

[내용]

---

## [섹션2]

[내용]

---

## 핵심 포인트

- 포인트1
- 포인트2
- 포인트3
```

---

## 💡 Best Practices

### DO ✅
- 인덱스 파일은 50-100줄 이내로 유지
- 각 상세 파일은 하나의 주제에 집중
- 상호 참조 링크를 명확히 표시
- 파일명에 번호를 붙여 순서 명시

### DON'T ❌
- 인덱스 파일에 상세 코드 포함
- 한 파일에 여러 주제 혼재
- 순환 참조 링크 생성
- 파일 분리 후 원본 파일 삭제 (백업 보관)

---

## 🔧 적용 대상 우선순위

### 우선 적용 (500줄 이상)
- [ ] Phase별 구현 문서
- [ ] 종합 가이드 문서
- [ ] 시나리오 모음 문서

### 선택 적용 (300-500줄)
- [ ] 자주 참조되는 문서
- [ ] 여러 주제를 다루는 문서

### 유지 (300줄 이하)
- 단일 주제 문서
- 체크리스트 문서
- 참고 자료 문서

---

## 📊 효과 측정

### Phase 5 최적화 결과
- **파일 수**: 1개 → 9개
- **평균 파일 크기**: 1,100줄 → 100줄
- **토큰 절감**: SignupService 확인 시 85% 절감
- **가독성**: 크게 향상
- **유지보수성**: 크게 향상

---

## 🔜 향후 계획

1. Phase 6-20 문서 작성 시 처음부터 분리 구조 적용
2. 기존 대용량 문서 순차적 최적화
3. 문서 템플릿 지속 개선

---

**참고:** 이 전략은 Phase 5 최적화 경험을 바탕으로 작성되었습니다.
